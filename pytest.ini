# pytest.ini
# Configuracao do pytest para testes BDD do ForgeLLMClient
#
# Referencias:
#   - project/specs/bdd/*.feature (Features Gherkin)
#   - project/specs/bdd/tracks.yml (Rastreabilidade)
#   - tests/bdd/ (Step definitions)

[pytest]
# Diretorios de testes
testpaths = tests

# Opcoes padrao
addopts = -v --tb=short

# Markers customizados para BDD
markers =
    # Por velocidade (CI)
    ci_fast: Testes rapidos, sem dependencias externas (mocks)
    ci_int: Testes de integracao, provedores locais
    e2e: Testes end-to-end, dependencias externas reais

    # Por dominio
    sdk: Core SDK Python
    chat: Funcionalidade de chat
    tools: Tool Calling
    tokens: Consumo de tokens
    response: Normalizacao de respostas
    contexto: Gestao de sessao/contexto
    providers: Provedores LLM

    # Por tipo
    erro: Cenarios de erro
    edge: Edge cases
    streaming: Respostas em stream
    compactacao: Compactacao de contexto

# Diretorio de features Gherkin
bdd_features_base_dir = project/specs/bdd

# Filtros padrao (executar apenas testes ci-fast por padrao)
# Para rodar outros: pytest -m "ci_int" ou pytest -m "e2e"
filterwarnings =
    ignore::DeprecationWarning
    ignore::PendingDeprecationWarning

# Configuracao de logging para testes
log_cli = true
log_cli_level = INFO
log_cli_format = %(asctime)s [%(levelname)8s] %(name)s: %(message)s
log_cli_date_format = %Y-%m-%d %H:%M:%S

# Timeout padrao para testes (em segundos)
# timeout = 30

# Cobertura de codigo (se pytest-cov estiver instalado)
# addopts = --cov=src --cov-report=html --cov-report=term-missing
